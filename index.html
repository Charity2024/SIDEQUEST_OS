<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SideQuestOS | Your Life, Ascended</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600&family=Cinzel+Decorative:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --glass: rgba(15, 23, 42, 0.65);
            --glass-border: rgba(255, 255, 255, 0.08);
            --accent: #10b981;
            --accent-glow: rgba(16, 185, 129, 0.3);
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: radial-gradient(circle at top right, #1e293b, #0f172a, #020617);
            color: #f8fafc;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .font-mystic { font-family: 'Cinzel Decorative', cursive; }

        /* Captivating Background Particles */
        .orb {
            position: fixed;
            border-radius: 50%;
            filter: blur(80px);
            z-index: -1;
            animation: float 20s infinite alternate;
            opacity: 0.15;
        }

        @keyframes float {
            0% { transform: translate(0, 0) scale(1); }
            100% { transform: translate(100px, 50px) scale(1.2); }
        }

        /* Glassmorphism Classes */
        .glass-card {
            background: var(--glass);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }

        .glass-nav {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--glass-border);
        }

        /* Interaction & Psychology: Visual Feedback */
        .quest-card {
            transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
            position: relative;
            overflow: hidden;
        }

        .quest-card:hover {
            transform: translateY(-5px) scale(1.01);
            border-color: rgba(16, 185, 129, 0.4);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4), 0 0 20px var(--accent-glow);
        }

        /* Shimmer Effect for Progress */
        .shimmer {
            position: relative;
            overflow: hidden;
        }
        .shimmer::after {
            content: '';
            position: absolute;
            top: 0; left: -100%;
            width: 50%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shimmer 3s infinite;
        }
        @keyframes shimmer {
            100% { left: 200%; }
        }

        /* Level Up Animation */
        @keyframes levelPop {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); color: #fbbf24; }
            100% { transform: scale(1); }
        }
        .level-up { animation: levelPop 0.8s ease-out; }

        .btn-mystic {
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.4);
            transition: all 0.3s ease;
        }
        .btn-mystic:hover {
            box-shadow: 0 0 25px rgba(16, 185, 129, 0.6);
            transform: translateY(-1px);
        }
    </style>
</head>
<body>
    <div class="orb w-[500px] h-[500px] bg-emerald-500 top-[-10%] left-[-10%]"></div>
    <div class="orb w-[400px] h-[400px] bg-blue-600 bottom-[10%] right-[-5%]"></div>

    <nav class="glass-nav sticky top-0 z-50">
        <div class="max-w-5xl mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 bg-emerald-500 rounded-lg rotate-45 flex items-center justify-center shadow-lg shadow-emerald-500/20">
                    <i data-lucide="shield" class="-rotate-45 text-white w-5 h-5"></i>
                </div>
                <h1 class="font-mystic text-2xl tracking-tighter text-white">SideQuest<span class="text-emerald-400">OS</span></h1>
            </div>
            <div class="flex gap-8 text-slate-400">
                <button onclick="showPage('dashboard')" class="nav-link hover:text-emerald-400 transition-all flex items-center gap-2" id="nav-dash">
                    <i data-lucide="compass" size="18"></i> <span class="text-xs uppercase tracking-widest font-semibold hidden md:inline">Sanctuary</span>
                </button>
                <button onclick="showPage('quests')" class="nav-link hover:text-emerald-400 transition-all flex items-center gap-2" id="nav-quests">
                    <i data-lucide="scroll" size="18"></i> <span class="text-xs uppercase tracking-widest font-semibold hidden md:inline">Grimoire</span>
                </button>
                <button onclick="showPage('achievements')" class="nav-link hover:text-emerald-400 transition-all flex items-center gap-2" id="nav-ach">
                    <i data-lucide="sparkles" size="18"></i> <span class="text-xs uppercase tracking-widest font-semibold hidden md:inline">Relics</span>
                </button>
            </div>
        </div>
    </nav>

    <main class="max-w-5xl mx-auto px-6 py-12">
        
        <section id="dashboard" class="page-content space-y-12">
            <div class="glass-card rounded-3xl p-8 flex flex-col md:flex-row items-center gap-8 relative overflow-hidden">
                <div class="text-center md:text-left z-10">
                    <h2 class="text-emerald-500 text-xs uppercase tracking-[0.4em] font-bold mb-2">Soul Progression</h2>
                    <div id="player-level" class="text-7xl font-mystic text-white mb-2 transition-all">LVL 1</div>
                    <p id="xp-text" class="text-slate-400 font-medium">0 / 200 Essence</p>
                </div>
                <div class="flex-1 w-full z-10">
                    <div class="h-4 bg-slate-900/50 rounded-full border border-white/5 p-1 shadow-inner">
                        <div id="xp-bar" class="h-full bg-gradient-to-r from-emerald-600 via-emerald-400 to-teal-400 rounded-full w-0 transition-all duration-1000 shimmer"></div>
                    </div>
                </div>
            </div>

            <div class="text-center space-y-4">
                <label class="text-slate-500 text-xs uppercase tracking-[0.5em]">The Eternal Focus</label>
                <input id="main-quest-input" type="text" placeholder="What is your current destiny?" 
                    class="bg-transparent border-none text-center text-3xl md:text-5xl font-mystic w-full focus:outline-none text-white placeholder-slate-800 transition-all focus:placeholder-transparent"
                    onchange="saveMainQuest(this.value)">
                <div class="h-[1px] w-32 bg-gradient-to-r from-transparent via-emerald-500 to-transparent mx-auto"></div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="md:col-span-2 space-y-6">
                    <div class="flex justify-between items-center">
                        <h3 class="font-mystic text-xl">Active Rituals</h3>
                        <button onclick="showPage('quests')" class="text-emerald-500 text-xs uppercase tracking-widest hover:text-emerald-300">Open Grimoire â†’</button>
                    </div>
                    <div id="dashboard-quests" class="grid grid-cols-1 gap-4">
                        </div>
                </div>
                <div class="glass-card rounded-2xl p-6 h-fit space-y-6">
                    <h3 class="font-mystic text-lg border-b border-white/5 pb-3">Statistics</h3>
                    <div class="space-y-4" id="stats-container">
                        </div>
                </div>
            </div>
        </section>

        <section id="quests" class="page-content hidden space-y-8">
            <div class="flex justify-between items-end">
                <div>
                    <h2 class="font-mystic text-4xl mb-2">The Grimoire</h2>
                    <p class="text-slate-400">Document your weekly trials and spontaneous adventures.</p>
                </div>
                <button onclick="toggleModal(true)" class="btn-mystic text-white px-6 py-3 rounded-xl font-bold flex items-center gap-2">
                    <i data-lucide="plus-circle" size="20"></i> Manifest Quest
                </button>
            </div>
            <div id="quest-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                </div>
        </section>

        <section id="achievements" class="page-content hidden space-y-8 text-center">
            <div class="max-w-2xl mx-auto">
                <h2 class="font-mystic text-4xl mb-2">Ancestral Relics</h2>
                <p class="text-slate-400 mb-12">Echoes of your past triumphs and consistency.</p>
                <div id="achievements-grid" class="grid grid-cols-2 md:grid-cols-3 gap-8">
                    </div>
            </div>
        </section>
    </main>

    <div id="quest-modal" class="fixed inset-0 bg-slate-950/90 backdrop-blur-md hidden items-center justify-center z-[100] p-6">
        <div class="glass-card w-full max-w-lg rounded-3xl p-10 relative">
            <button onclick="toggleModal(false)" class="absolute top-6 right-6 text-slate-500 hover:text-white">
                <i data-lucide="x"></i>
            </button>
            <h3 class="font-mystic text-3xl mb-8">New Side Quest</h3>
            <div class="space-y-6">
                <div class="space-y-2">
                    <label class="text-xs uppercase tracking-widest text-emerald-500 font-bold">Intent</label>
                    <input id="q-title" type="text" placeholder="e.g., Master the Void (Meditation)" 
                        class="w-full bg-slate-950/50 border border-white/10 rounded-xl p-4 focus:border-emerald-500 outline-none text-white transition-all">
                </div>
                <div class="grid grid-cols-2 gap-6">
                    <div class="space-y-2">
                        <label class="text-xs uppercase tracking-widest text-slate-500 font-bold">Intensity</label>
                        <select id="q-diff" class="w-full bg-slate-950/50 border border-white/10 rounded-xl p-4 outline-none text-white appearance-none">
                            <option value="Easy">Minor (10 XP)</option>
                            <option value="Medium">Moderate (30 XP)</option>
                            <option value="Wild">Legendary (100 XP)</option>
                        </select>
                    </div>
                    <div class="space-y-2">
                        <label class="text-xs uppercase tracking-widest text-slate-500 font-bold">Duration</label>
                        <select id="q-time" class="w-full bg-slate-950/50 border border-white/10 rounded-xl p-4 outline-none text-white appearance-none">
                            <option value="1 Day">A Single Sun</option>
                            <option value="1 Week">A Full Moon</option>
                        </select>
                    </div>
                </div>
                <button onclick="addQuest()" class="w-full btn-mystic text-white py-4 rounded-xl font-bold text-lg mt-4">Commence Quest</button>
            </div>
        </div>
    </div>

    <script>
        // Initial State
        let state = {
            mainQuest: "",
            xp: 0,
            quests: [],
            achievements: [
                { id: 'first-step', name: 'Ascended', desc: 'Your journey begins', icon: 'zap', unlocked: false },
                { id: 'consistency-mage', name: 'Archmage', desc: 'Reach Level 3', icon: 'crown', unlocked: false },
                { id: 'fear-slayer', name: 'Beast Slayer', desc: 'Triumph over a Wild Quest', icon: 'sword', unlocked: false }
            ]
        };

        // Utility: Sound Effects (Psychology: Audio Feedback)
        const playSfx = (type) => {
            // Using a simple Oscillator for a "magical" chime without external assets
            const ctx = new (window.AudioContext || window.webkitAudioContext)();
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.connect(gain);
            gain.connect(ctx.destination);
            osc.type = 'sine';
            osc.frequency.setValueAtTime(type === 'complete' ? 880 : 440, ctx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.00001, ctx.currentTime + 1);
            osc.start();
            osc.stop(ctx.currentTime + 1);
        };

        // Data Management
        function loadData() {
            const saved = localStorage.getItem('sideQuestOS_v2');
            if (saved) {
                state = JSON.parse(saved);
                document.getElementById('main-quest-input').value = state.mainQuest || "";
            }
            render();
        }

        function saveData() {
            localStorage.setItem('sideQuestOS_v2', JSON.stringify(state));
            render();
        }

        // Actions
        function saveMainQuest(val) {
            state.mainQuest = val;
            saveData();
        }

        function addQuest() {
            const title = document.getElementById('q-title').value;
            const diff = document.getElementById('q-diff').value;
            const time = document.getElementById('q-time').value;
            if (!title) return;

            state.quests.unshift({
                id: Date.now(),
                title,
                difficulty: diff,
                timeframe: time,
                status: 'Not Started',
                created: new Date().toLocaleDateString()
            });

            toggleModal(false);
            document.getElementById('q-title').value = '';
            saveData();
        }

        function updateQuestStatus(id) {
            const quest = state.quests.find(q => q.id === id);
            const levels = { 'Not Started': 'In Progress', 'In Progress': 'Completed', 'Completed': 'Not Started' };
            
            if (quest.status !== 'Completed' && levels[quest.status] === 'Completed') {
                const reward = { 'Easy': 10, 'Medium': 30, 'Wild': 100 }[quest.difficulty];
                state.xp += reward;
                playSfx('complete');
                checkAchievements(quest);
            }
            
            quest.status = levels[quest.status];
            saveData();
        }

        function checkAchievements(lastQuest) {
            state.achievements[0].unlocked = true; // First Step
            if (lastQuest.difficulty === 'Wild') state.achievements[2].unlocked = true;
            if (Math.floor(state.xp / 200) + 1 >= 3) state.achievements[1].unlocked = true;
        }

        // Render Functions
        function showPage(pageId) {
            document.querySelectorAll('.page-content').forEach(p => p.classList.add('hidden'));
            document.getElementById(pageId).classList.remove('hidden');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function toggleModal(show) {
            document.getElementById('quest-modal').style.display = show ? 'flex' : 'none';
        }

        function render() {
            const level = Math.floor(state.xp / 200) + 1;
            const currentLevelXP = state.xp % 200;
            const progress = (currentLevelXP / 200) * 100;

            // UI Elements
            const lvlEl = document.getElementById('player-level');
            if(lvlEl.innerText !== `LVL ${level}`) {
                lvlEl.classList.add('level-up');
                setTimeout(() => lvlEl.classList.remove('level-up'), 800);
            }
            lvlEl.innerText = `LVL ${level}`;
            document.getElementById('xp-text').innerText = `${currentLevelXP} / 200 Essence`;
            document.getElementById('xp-bar').style.width = `${progress}%`;

            // Render Quests
            const activeQuests = state.quests.filter(q => q.status !== 'Completed');
            document.getElementById('dashboard-quests').innerHTML = activeQuests.slice(0, 3).map(q => createCard(q, true)).join('');
            document.getElementById('quest-grid').innerHTML = state.quests.map(q => createCard(q, false)).join('');

            // Stats
            document.getElementById('stats-container').innerHTML = `
                <div class="flex justify-between text-sm"><span class="text-slate-500 uppercase tracking-tighter">Total Essence</span><span class="text-emerald-400 font-bold">${state.xp}</span></div>
                <div class="flex justify-between text-sm"><span class="text-slate-500 uppercase tracking-tighter">Quests Vanquished</span><span class="text-white font-bold">${state.quests.filter(q => q.status === 'Completed').length}</span></div>
                <div class="flex justify-between text-sm"><span class="text-slate-500 uppercase tracking-tighter">Active Rituals</span><span class="text-white font-bold">${activeQuests.length}</span></div>
            `;

            // Achievements
            document.getElementById('achievements-grid').innerHTML = state.achievements.map(a => `
                <div class="group relative">
                    <div class="w-24 h-24 mx-auto rounded-full glass-card flex items-center justify-center border-2 transition-all duration-500 ${a.unlocked ? 'border-emerald-500/50 shadow-[0_0_20px_rgba(16,185,129,0.2)]' : 'border-white/5 grayscale opacity-30'}">
                        <i data-lucide="${a.icon}" class="${a.unlocked ? 'text-emerald-400' : 'text-slate-500'}" size="32"></i>
                    </div>
                    <h4 class="font-mystic mt-4 text-sm ${a.unlocked ? 'text-white' : 'text-slate-600'}">${a.name}</h4>
                    <p class="text-[10px] text-slate-500 uppercase tracking-widest mt-1">${a.unlocked ? a.desc : '???'}</p>
                </div>
            `).join('');

            lucide.createIcons();
        }

        function createCard(q, isDash) {
            const colors = { 'Easy': 'text-cyan-400', 'Medium': 'text-emerald-400', 'Wild': 'text-rose-500' };
            const statusIcons = { 'Not Started': 'circle', 'In Progress': 'loader-2', 'Completed': 'check-circle-2' };
            const isComp = q.status === 'Completed';

            return `
                <div class="quest-card glass-card rounded-2xl p-6 ${isComp ? 'opacity-50' : ''}">
                    <div class="flex justify-between items-start mb-4">
                        <span class="text-[10px] font-bold uppercase tracking-[0.2em] ${colors[q.difficulty]}">${q.difficulty}</span>
                        <span class="text-[10px] text-slate-500 font-bold">${q.timeframe}</span>
                    </div>
                    <h4 class="text-lg font-semibold text-white mb-6 leading-tight ${isComp ? 'line-through' : ''}">${q.title}</h4>
                    <div class="flex justify-between items-center">
                        <button onclick="updateQuestStatus(${q.id})" class="flex items-center gap-2 text-xs font-bold uppercase tracking-widest transition-all ${isComp ? 'text-emerald-500' : 'text-slate-400 hover:text-white'}">
                            <i data-lucide="${statusIcons[q.status]}" size="16" class="${q.status === 'In Progress' ? 'animate-spin' : ''}"></i>
                            ${q.status}
                        </button>
                        ${!isDash ? `<button onclick="deleteQuest(${q.id})" class="text-slate-700 hover:text-rose-500 transition-colors"><i data-lucide="trash-2" size="14"></i></button>` : ''}
                    </div>
                </div>
            `;
        }

        function deleteQuest(id) {
            state.quests = state.quests.filter(q => q.id !== id);
            saveData();
        }

        // Start the engine
        window.onload = loadData;
    </script>
</body>
</html>